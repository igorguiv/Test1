{"name":"Audio Step Sequencer — single HTML file","type":"code/html","content":"<!doctype html>\n<html lang="en">\n<head>\n  <meta charset="utf-8" />\n  <meta name="viewport" content="width=device-width,initial-scale=1" />\n  <title>Audio Step Sequencer</title>\n  <style>\n    :root{\n      --bg:#05060a; --panel:#0b0f18; --accent:#6be3ff; --accent2:#8a6bff; --muted:#9aa8b2;\n      --glass: rgba(255,255,255,0.04);\n    }\n    {box-sizing:border-box}\n    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}\n    body{background:radial-gradient(1200px 600px at 10% 10%, rgba(106,31,255,0.08), transparent), radial-gradient(900px 500px at 90% 90%, rgba(107,227,255,0.04), transparent), var(--bg); color:#dcecff}\n    .app{max-width:1100px;margin:28px auto;padding:22px;border-radius:14px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));box-shadow:0 8px 30px rgba(2,6,23,0.7);}\n    header{display:flex;align-items:center;gap:18px}\n    .logo{width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:700;color:#041022;font-size:18px;box-shadow:0 6px 24px rgba(91,70,255,0.12),0 1px 0 rgba(255,255,255,0.03) inset}\n    h1{margin:0;font-size:20px;letter-spacing:0.6px}\n    p.lead{margin:0;color:var(--muted);font-size:13px}\n    .controls{display:flex;gap:12px;margin-top:16px;align-items:center}\n    .control{background:var(--glass);padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.02);min-width:120px}\n    .control label{display:block;font-size:11px;color:var(--muted);margin-bottom:6px}\n    .control input[type=range]{width:100%}\n    .buttons{display:flex;gap:10px}\n    button.btn{background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.04);padding:10px 14px;border-radius:10px;color:var(--accent);cursor:pointer}\n    button.btn.play{background:linear-gradient(90deg,var(--accent),var(--accent2));color:#041022;box-shadow:0 6px 30px rgba(107,227,255,0.08)}\n    main{margin-top:18px;display:grid;grid-template-columns:1fr 300px;gap:18px}\n    .sequencer{background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent);padding:14px;border-radius:12px}\n    .row{display:grid;grid-template-columns:150px 1fr;gap:12px;align-items:center;padding:8px 0;border-bottom:1px solid rgba(255,255,255,0.02)}\n    .row:last-child{border-bottom:0}\n    .inst{display:flex;align-items:center;gap:10px}\n    .inst .dot{width:12px;height:12px;border-radius:50%;background:linear-gradient(180deg,var(--accent),var(--accent2));box-shadow:0 8px 18px rgba(107,227,255,0.04)}\n    .grid{display:grid;grid-template-columns: repeat(16, 1fr);gap:6px}\n    .step{aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;border-radius:6px;background:rgba(255,255,255,0.015);cursor:pointer;transition:transform .08s,box-shadow .08s}\n    .step.active{background:linear-gradient(180deg, rgba(107,227,255,0.12), rgba(138,107,255,0.08));box-shadow:0 6px 18px rgba(107,227,255,0.06);transform:translateY(-4px)}\n    .step.playing{outline:2px solid rgba(255,255,255,0.04);box-shadow:0 0 18px rgba(255,255,255,0.02) inset}\n    .sidepanel{padding:14px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);border-radius:12px}\n    .list{max-height:220px;overflow:auto;margin-top:10px}\n    .pattern-item{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01);margin-bottom:8px}\n    .small{font-size:12px;color:var(--muted)}\n    input[type=text]{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit}\n    footer{margin-top:14px;color:var(--muted);font-size:12px;text-align:center}\n    .bpm{font-weight:700;font-size:18px}\n    / fun neon animations /\n    .logo:after{content:'';position:absolute;width:120px;height:120px;border-radius:50%;filter:blur(20px);opacity:0.08;transform:translate(-20px,-20px);pointer-events:none}\n    .glow{position:relative}\n    .pulse{position:absolute;right:8px;top:8px;width:12px;height:12px;border-radius:50%;background:transparent;box-shadow:0 0 16px 6px rgba(107,227,255,0.06);animation:pulse 1500ms linear infinite}\n    @keyframes pulse{0%{transform:scale(0.9);opacity:0.9}50%{transform:scale(1.4);opacity:0.2}100%{transform:scale(0.9);opacity:0.9}}\n    @media (max-width:900px){main{grid-template-columns:1fr} .controls{flex-wrap:wrap}}\n  </style>\n</head>\n<body>\n  <div class="app">\n    <header>\n      <div class="logo">A•SS</div>\n      <div>\n        <h1>Audio Step Sequencer</h1>\n        <p class="lead">16-step drum grid · WebAudio · Tempo · Swing · Save/Load · Export WAV</p>\n      </div>\n      <div style="margin-left:auto;display:flex;gap:10px;align-items:center">\n        <div class="pulse"></div>\n      </div>\n    </header>\n\n    <div class="controls">\n      <div class="control">\n        <label>BPM <span id="bpmLabel" class="bpm">120</span></label>\n        <input id="bpm" type="range" min="40" max="220" value="120">\n      </div>\n      <div class="control">\n        <label>Swing <span id="swingLabel" class="small">0%</span></label>\n        <input id="swing" type="range" min="0" max="60" value="0">\n      </div>\n      <div class="control">\n        <label>Volume</label>\n        <input id="masterVol" type="range" min="0" max="1" step="0.01" value="0.9">\n      </div>\n\n      <div class="buttons" style="margin-left:auto">\n        <button id="play" class="btn play">Play</button>\n        <button id="stop" class="btn">Stop</button>\n        <button id="export" class="btn">Export WAV</button>\n      </div>\n    </div>\n\n    <main>\n      <section class="sequencer" id="sequencer">\n        <!-- instrument rows inserted by JS -->\n      </section>\n\n      <aside class="sidepanel">\n        <div>\n          <label>Pattern name</label>\n          <input id="patternName" type="text" placeholder="My pattern">\n          <div style="display:flex;gap:8px;margin-top:8px">\n            <button id="savePattern" class="btn">Save</button>\n            <button id="loadPattern" class="btn">Load</button>\n            <button id="clearPattern" class="btn">Clear</button>\n          </div>\n        </div>\n\n        <div style="margin-top:12px">\n          <label>Saved patterns</label>\n          <div class="list" id="patternList"></div>\n        </div>\n\n        <div style="margin-top:12px">\n          <label class="small">Export/Import</label>\n          <div style="display:flex;gap:6px;margin-top:6px">\n            <button id="exportJSON" class="btn">Export JSON</button>\n            <button id="importJSONBtn" class="btn">Import JSON</button>\n            <input type="file" id="importJSON" accept="application/json" style="display:none">\n          </div>\n        </div>\n\n        <div style="margin-top:12px" class="small">Tips: click steps to toggle. Swing delays every 2nd step. Export uses offline rendering.</div>\n      </aside>\n    </main>\n\n    <footer>Built with ❤️ and WebAudio — play, save, export, and make beats!</footer>\n  </div>\n\n<script>\n// Audio Step Sequencer - single file\nconst ctx = new (window.AudioContext || window.webkitAudioContext)();\nlet isPlaying = false;\nlet currentStep = 0;\nlet timerID = null;\nlet startTime = 0;\nlet scheduleAheadTime = 0.1; // seconds\nlet lookahead = 25; // ms\nlet nextNoteTime = 0.0; // when the next note is due\nconst steps = 16;\nconst instruments = [\n  {id:'Kick', type:'kick'},\n  {id:'Snare', type:'snare'},\n  {id:'HiHat', type:'hihat'},\n  {id:'Clap', type:'clap'}\n];\nlet grid = [];\nconst master = ctx.createGain(); master.gain.value = 0.9; master.connect(ctx.destination);\n\n// UI refs\nconst sequencerEl = document.getElementById('sequencer');\nconst bpmEl = document.getElementById('bpm');\nconst bpmLabel = document.getElementById('bpmLabel');\nconst swingEl = document.getElementById('swing');\nconst swingLabel = document.getElementById('swingLabel');\nconst playBtn = document.getElementById('play');\nconst stopBtn = document.getElementById('stop');\nconst exportBtn = document.getElementById('export');\nconst masterVol = document.getElementById('masterVol');\nconst patternName = document.getElementById('patternName');\nconst savePatternBtn = document.getElementById('savePattern');\nconst loadPatternBtn = document.getElementById('loadPattern');\nconst clearPatternBtn = document.getElementById('clearPattern');\nconst patternList = document.getElementById('patternList');\nconst exportJSON = document.getElementById('exportJSON');\nconst importJSONBtn = document.getElementById('importJSONBtn');\nconst importJSON = document.getElementById('importJSON');\n\n// init grid\nfor(let i=0;i<instruments.length;i++){ grid[i]=new Array(steps).fill(false) }\n\nfunction createUI(){\n  sequencerEl.innerHTML='';\n  instruments.forEach((inst,i)=>{\n    const row = document.createElement('div'); row.className='row';\n    const left = document.createElement('div'); left.className='inst';\n    left.innerHTML = <div class=\"dot\"></div><div><strong>${inst.id}</strong><div class=\"small\">${inst.type}</div></div>;\n    const right = document.createElement('div'); right.className='grid';\n    for(let s=0;s<steps;s++){\n      const step = document.createElement('div'); step.className='step'; step.dataset.inst=i; step.dataset.step=s; step.title=Step ${s+1};\n      step.addEventListener('click', () => { toggleStep(i,s); });\n      right.appendChild(step);\n    }\n    row.appendChild(left); row.appendChild(right);\n    sequencerEl.appendChild(row);\n  });\n}\ncreateUI();\n\nfunction toggleStep(i,s){ grid[i][s]=!grid[i][s]; renderGrid(); }\nfunction clearGrid(){ for(let i=0;i<grid.length;i++) grid[i].fill(false); renderGrid(); }\nfunction renderGrid(){\n  document.querySelectorAll('.step').forEach(el=>{\n    const i = +el.dataset.inst; const s = +el.dataset.step;\n    el.classList.toggle('active', grid[i][s]);\n    el.classList.toggle('playing', s===currentStep);\n  });\n}\n\n// simple drum synthesis\nfunction playSound(type, time){\n  if(type==='kick'){\n    const o = ctx.createOscillator(); const g = ctx.createGain();\n    o.type='sine'; o.frequency.setValueAtTime(150, time);\n    o.frequency.exponentialRampToValueAtTime(50, time+0.25);\n    g.gain.setValueAtTime(1, time); g.gain.exponentialRampToValueAtTime(0.001, time+0.5);\n    o.connect(g); g.connect(master); o.start(time); o.stop(time+0.6);\n  } else if(type==='snare'){\n    // noise\n    const bufferSize = ctx.sampleRate * 0.2; const noiseBuffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate);\n    const data = noiseBuffer.getChannelData(0); for(let i=0;i<bufferSize;i++) data[i]=Math.random()2-1;\n    const nb = ctx.createBufferSource(); nb.buffer=noiseBuffer; const ng = ctx.createGain(); ng.gain.setValueAtTime(1, time); ng.gain.exponentialRampToValueAtTime(0.01, time+0.2);\n    const hp = ctx.createBiquadFilter(); hp.type='highpass'; hp.frequency.value=1000;\n    nb.connect(hp); hp.connect(ng); ng.connect(master); nb.start(time); nb.stop(time+0.25);\n    // tone\n    const o = ctx.createOscillator(); const og = ctx.createGain(); o.type='triangle'; o.frequency.value=220; og.gain.setValueAtTime(0.6, time); og.gain.exponentialRampToValueAtTime(0.001, time+0.2);\n    o.connect(og); og.connect(master); o.start(time); o.stop(time+0.3);\n  } else if(type==='hihat'){\n    const bufferSize = ctx.sampleRate * 0.05; const noiseBuffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate);\n    const data = noiseBuffer.getChannelData(0); for(let i=0;i<bufferSize;i++) data[i]=Math.random()2-1;\n    const nb = ctx.createBufferSource(); nb.buffer=noiseBuffer; const ng = ctx.createGain(); ng.gain.setValueAtTime(0.6, time); ng.gain.exponentialRampToValueAtTime(0.001, time+0.06);\n    const hp = ctx.createBiquadFilter(); hp.type='highpass'; hp.frequency.value=7000;\n    nb.connect(hp); hp.connect(ng); ng.connect(master); nb.start(time); nb.stop(time+0.08);\n  } else if(type==='clap'){\n    // layered noises\n    for(let i=0;i<3;i++){\n      const bufferSize = ctx.sampleRate * 0.12; const noiseBuffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate);\n      const data = noiseBuffer.getChannelData(0); for(let j=0;j<bufferSize;j++) data[j]=Math.random()2-1;\n      const nb = ctx.createBufferSource(); nb.buffer=noiseBuffer; const ng = ctx.createGain(); ng.gain.setValueAtTime(0.7/(i+1), time+ i0.02);\n      ng.gain.exponentialRampToValueAtTime(0.01, time+0.16);\n      const hp = ctx.createBiquadFilter(); hp.type='highpass'; hp.frequency.value=1200 + i800;\n      nb.connect(hp); hp.connect(ng); ng.connect(master); nb.start(time+ i0.02); nb.stop(time+0.2+i0.02);\n    }\n  }\n}\n\n// scheduler\nfunction nextNote(){\n  const bpm = +bpmEl.value;\n  const secondsPerBeat = 60.0 / bpm; // quarter note\n  const subdivision = 4; // 16 steps = 4 beats per bar * 4 subdiv = 16\n  const stepDur = secondsPerBeat / (subdivision/4); // actually seconds per 16th: = 60/bpm /4\n  // step duration more simply:\n  const sixteenth = 60.0 / bpm / 4;\n  // apply swing: odd steps (1-based) get a delay forward\n  const swingPercent = +swingEl.value / 100.0; // 0..0.6 -> but label shows 0..60\n  nextNoteTime += sixteenth; // schedule next step baseline\n  currentStep = (currentStep + 1) % steps;\n}\n\nfunction scheduler(){\n  while(nextNoteTime < ctx.currentTime + scheduleAheadTime){\n    // schedule notes for currentStep\n    const stepToPlay = currentStep;\n    // compute swing offset: delay for odd steps (1-based)\n    const stepIndex1based = stepToPlay + 1;\n    const swingAmt = (+swingEl.value)/100.0; // 0..0.6\n    const sixteenth = 60.0 / (+bpmEl.value) / 4;\n    let time = nextNoteTime;\n    if(stepIndex1based % 2 === 0){ // even step -> push forward by swing\n      time += sixteenth * swingAmt * 0.5; // scaled\n    }\n    grid.forEach((row,i)=>{\n      if(row[stepToPlay]) playSound(instruments[i].type, time);\n    });\n    // mark UI\n    renderGrid();\n    // advance\n    nextNoteTime += sixteenth;\n    currentStep = (currentStep + 1) % steps;\n  }\n  timerID = setTimeout(scheduler, lookahead);\n}\n\nfunction start(){\n  if(ctx.state === 'suspended') ctx.resume();\n  if(isPlaying) return;\n  isPlaying = true; playBtn.textContent='Playing'; playBtn.classList.add('play');\n  currentStep = -1; nextNoteTime = ctx.currentTime + 0.05; // small offset\n  scheduler();\n}\nfunction stop(){\n  if(!isPlaying) return;\n  isPlaying = false; playBtn.textContent='Play';

